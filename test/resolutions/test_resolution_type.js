const {test} = require('@alexbosworth/tap');

const {resolutionType} = require('./../../resolutions');

const tests = [
  {
    args: {
      transaction: '02000000000101ddcd0a8bac799449d6032f1c09b4ecb2fa1f48c9b801084f1239a7a16e6cc3d20000000000e001000001197f0c00000000001600142837ab3877dabede38c8dc28045b338fd405849e03483045022100d36c08ee9f016c981e83aed10d199d2f8897456b06ce870265adb8fbfc6f36bd0220633acd45d93de8604ea84e030de8d98e8401e32aedf5c3382d7bad603b31fdf301004d6321024196926ad64c09cec89ee66725c5148fd2a52a5eae3a19a5668d70eef8b6a4c36702e001b2752103f87f9850d5529e877caef71d202131c1433c84f6ccb24120e1205ba3124f7cac68acd9ce0800',
      vin: 0,
    },
    description: 'CSV delayed output',
    expected: {type: 'csv_delayed'},
  },
  {
    args: {
      transaction: '02000000000101ac9b0c7789dc910e2d45d0b285a988a5694dcc9097983676431433915dbdc02300000000000000000001e05c0700000000002200200e7844380de5e31e7c40a8679c0273ea0af0295a4d58dc987f51656c0ac539d50500473044022033848e2f1c319111f48e414894562e02ef29a696ce6193d26696848ac6331b7202202d8e673f026a56fee32b93665babf2d4a6e70843da5a7b853ae8e19637d824ba01473044022019e1113150ea58d69a53930872387e5c722c23b8fb399497cc5ac4e276ba2f5902203256c0811db24cba16a09a6165d2cd77033f9dd67a1c2303028f79c089def8d301008576a91459f163aba7b55413a852fb1eada13d0d89e488918763ac672103566233faa157eae76dcade6a8594ce38729e157ff583a44a442f43fd3312cb6d7c820120876475527c21039d15f95af63bd0316e2c7a82c84d3139ef7900961c0e9a3a90462ebce4c0d37252ae67a9145dc7a3df22079ba503b2e9c73ed068f05895c10e88ac6868a7c80800',
      vin: 0,
    },
    description: 'Offered HTLC timeout',
    expected: {type: 'offered_htlc_timeout'},
  },
  {
    args: {
      transaction: '020000000001019e901f24fe92b547d457e543397ff6b058414fda423147de7f5b80485fe0f77801000000000000000001e2462e00000000001600141a4051f3f29c406deb56dd0531459f3691b9d7d402473044022048f8e11c4ed55ac956613fdfb5baf3ceaea4a953d4fdaba7fa83158c52e7831c02204605ac2aa34753e1be2ff63a5806b106fb40f015c8ef688cb971dbd3f2e3ca74012102deb79556e61246f30343d68621ec0ee654ef4ba6150a21d59aff25a6a6d9587600d00800',
      vin: 0,
    },
    description: 'Pay to witness public key hash',
    expected: {type: 'p2wpkh'},
  },
  {
    args: {
      transaction: '020000000001014177feadb67204ea202130aa8d5f1f4e08b622df7d03ddfedeeebedbc4a6b04700000000000600000001b41f6300000000001600148ea753221568a01db63756d79fc691797b07f6650347304402206a56355dbb752fd09730d2382492b5cc6d44101fb42bfff0e6c59dc72ef0125c02207bec1d78f87c3103146f6a3187542f51df06e6c95c05f44b03ac69a89bad110001004b632102891c274b2f7c6d622cb3136a4324ab6a046218885fb37d29eac0c2a8d26ebe8a6756b27521034ca958744047a30dfce11dff5898f2db91a4f64876e43dd7f4c5d277361c1dd968ac25f11700',
      vin: 0,
    },
    description: 'Short CSV delay',
    expected: {type: 'csv_delayed'},
  },
  {
    args: {
      transaction: '0200000000010208a0f5cacb1ba32df8965eadc3c058fb565f398360400325fb537af300ade0fc02000000000100000008a0f5cacb1ba32df8965eadc3c058fb565f398360400325fb537af300ade0fc000000000000000000016a25010000000000220020be056fa80cc900380cfac9149d34bacac1a8f02244d56b40b0c1c364041ae854050047304402202aa0e8056a481aae103b08e619263826ae01d3b89236a6d6061d165ef1dd0cea02205899bac2250873c59603414788cd99561229013a5c2642d9751542d49dacc8ef834730440220757e831c66a77c65cfcbeda7145442d0a45a71ed71a8fb1d817dede6ebd8bd40022043c93b7cd949fbdf64b8c889f4e83f1e7d180276e1540966d0d24734147c120d01008876a91485df2db4caa9f7cfb9cf5b5226f258eb53dc43628763ac67210246dcbb0f4f4bc41917ab9a207ddcb166b5eb3512913953a130cc25168c47cbad7c820120876475527c210301bddbb434cb8a2ba90f7354d420c64311197cdfd9fa80f767705c23968dd4b852ae67a9144e9a7125e6e45a33edfa41ea99ccbb712512d83288ac6851b2756802473044022022f0d0d9767304a2b8d429d43a797a3fc99600c9c805dd2967b87fc0df5bcc91022042d17ed85b6fef3c2603e1d559b831d614954c256d1318c2061ef200c90f0256012821035d8688ca665bbd73d3d5b7264d0304399b529a9ed37e361a401be8408b76c3a5ac736460b26803212500',
      vin: 0,
    },
    description: 'Anchor channel resolution type',
    expected: {type: 'offered_htlc_timeout'},
  },
  {
    args: {
      transaction: '0200000000010acc77ab51ada950709117e64cbffc886f4ac22085e37758ad67476b67bf90fc780500000000010000006644aeb600e9b534b29908615b25846c98eb8b71c58f7d7f53518dc3db20c1db0300000000010000008aa7cf3ae95eb827029d242a481fcdf731aa192ea96b2530f924f7ba882d09d9020000000001000000c76eb9c387a10870393d05c478a17ebcadebe5752f0883135bfb4f0de1fb4fb80300000000010000009c79e82f8171a60b40fb1a08fd8f0bdb93d1c28806f22ef9da70a1582e9ea8570300000000010000006644aeb600e9b534b29908615b25846c98eb8b71c58f7d7f53518dc3db20c1db000000000000000000c76eb9c387a10870393d05c478a17ebcadebe5752f0883135bfb4f0de1fb4fb8000000000000000000cc77ab51ada950709117e64cbffc886f4ac22085e37758ad67476b67bf90fc780100000000000000009c79e82f8171a60b40fb1a08fd8f0bdb93d1c28806f22ef9da70a1582e9ea8570000000000000000008aa7cf3ae95eb827029d242a481fcdf731aa192ea96b2530f924f7ba882d09d901000000000000000001f576480000000000225120b2a8452604112286fcee97c6f988c12af0973fbd4da5c5f1e86e823b1dec9c6e02483045022100807ca97b96cb742a4e64053913dff52da6000e896c171dbf75e897b8344f49f9022020d2a6074c9a7334aea6975d916daf13d467f49cd726452a71a774d1adfc2c1801252102e14a5eb26ee4b1dbd1752d62638e0202e2aedc66c151e5940f7136aacd63830ead51b202483045022100c6229f6d799453b9fd432b6d2a07ef3d5878d160e4b8464c573deea030d70a2f02204f225d775826875399c685c2e7611b17a97bc28b09b1047a61dcdac33641524001252102f9194917d756ef074a1accf30b4761e547feb065fc91f2d2f8d5c928a5cbe0b0ad51b20247304402204bad0420f01749abd2e1d49bb27149357f3c2408c82320ff1dd731eb41347335022001cdac94e7ee275a59c00538cbcb939cf3cbea1e78077d39d7d0e510c1b6136a012521033e60e387c25dbd7a1d17274a17ea8a18f6c7c43b9de102fd4caee416f2047783ad51b2024730440220663bbfa42094382b0a8a324cd1a9e8a43e72a12172ba9356c131bd396b32d9be022044cae91691a403c3f63d820c849b06483b1ada697308187ce92feab85105b89d0125210200dc214487b22e8824f4f64fb2ac8616cc57c22d8dc7c125b164683397a39c5cad51b202473044022035f4bcbe300d6c5672bd909811b3cc924cb81e51767d389b8882b51bc4fddb4602202b153e9f5f62e4326fc38bdcd852a26cb839a18dd77fb17a4dfc580013830ec401252102d934b3495bfc40ff34c3429096cc395cc2eb4e8fb1576855652083cbf49220b4ad51b20247304402205473116141994896d0d9e139b0d57061635a31bc5af343b862b3cac2481926170220330034a185996ceca497a9453c7e92732053c264d9fc6d4f134d077154f3094d0128210289dfa008d10f248a85bd98a02fc17aa749ca2dda9ce551b5f102840771aa9db8ac736460b26802483045022100ffeb4dbf61d7685faa2841ea3d5eb3d9bb7bceb549ad77cb1d290f69a1a1c9470220406f69e80085bf656edd7b3770cf58872118c236b0a0f7d0e508f89c1e533e34012821037db61512d6d763ddbb866c84707e317f6625c6d25419adf950b0f9c6101348aaac736460b26802473044022078991b355d4cb898ceecb6c455fe705d74ec24add7d149a3c131656ba135bb2e02204b565652ed03001bafc9b87dd37c3883a547c396518b97fdd8865e5e8881784401282102d388d6e005999fecea0f9c0f5cfcf4a0945858648e54ba433cd9cfbd84980619ac736460b26802483045022100a0a032f08237693b96ac8adea21affb6c739192a4108d35b3bcb2b7bc6d3feee02200d3f4f9c7466a1f1cfb903b5cc9c4bfbb7d3d65f4025d3332cb62e23364a2d49012821031ef0881bfdd6729566e20182e654a21385ce09417f0e00cd0f16daf3c5a04d5cac736460b26802473044022005af290f939c5536f0fe35ba603e6b16bbd57627c107361bb839fd31199c3a3102203e37fb029c711c8e31dc30d4d818b703a5be180626e0f5f565d40d871c27695601282102f8c61345f8dc2176ea0c1f99cad7bcb3f2ae5052a5351ab1170c81492db39596ac736460b2688b1a2500',
      vin: 0,
    },
    description: 'Anchor channel remote resolution type',
    expected: {type: 'to_remote'},
  },
  {
    args: {
      transaction: '02000000000104cc77ab51ada950709117e64cbffc886f4ac22085e37758ad67476b67bf90fc78030000000001000000cc77ab51ada950709117e64cbffc886f4ac22085e37758ad67476b67bf90fc78020000000001000000cc77ab51ada950709117e64cbffc886f4ac22085e37758ad67476b67bf90fc780000000000000000009410f796b5a57bf3b26bd8feabbb52473683c61dfab7200e8428fabf0e2d927100000000000000000003cf09000000000000220020cf71da525f820084432665a0d0b607df8f07918a659d122f74034c76dec2d565cf09000000000000220020cf71da525f820084432665a0d0b607df8f07918a659d122f74034c76dec2d565da9f070000000000225120ef606da28739952450b2f8273fd1796e70ee13efed619d72c91e35acc49b97d1050047304402203e10dcf7e537f1d0e2e5107dcef9256144bfcfa1799100b2f5e701acba42127f0220747bf9beae303500daab7ea2bd4b2326cb5c0623c8258ff1bf08805e3cb8d14783483045022100d378a3aea8c579a279974c445053705511117d4473d6ce92d8aaaf82751d5c3c02205de3ae5b168fe8fd0bd4cc6ccc509b8d172c000ec1bcaf35d782ed4989917ac401008876a91438c6cac1c04278e1bee19daa1f36f221756576dd8763ac6721026128421f202b6dedd34928e0b89995862ce901baa05e9dbee92d43e728efad687c820120876475527c21038ac65f58d7c3b0716fefbe26e98862d7bd5768e2c97c16bca265c15069428bc852ae67a914e6671ce9bb5c7490e8639cff1dc61667d39f880688ac6851b275680500483045022100d030e7bec156bd9bee940b56db81b3a73096014cf6b231d93e9e451231baba6d02207994079ad8a865fbcd393aa03ce8f40c54f42f32b16396b9fdb29eb377f6c0398347304402207405b5e5b210ca42f656d8b0010d41c14d752cecc701ba20ca5e98de8fa140a602204f20bc53109dce79e649f6823cc23f4136b50a4a2d54a6dd60632a3137bc2adb01008876a91438c6cac1c04278e1bee19daa1f36f221756576dd8763ac6721026128421f202b6dedd34928e0b89995862ce901baa05e9dbee92d43e728efad687c820120876475527c21038ac65f58d7c3b0716fefbe26e98862d7bd5768e2c97c16bca265c15069428bc852ae67a91412a38a492ea7aa10048df8d5be802bf68e14adf088ac6851b275680247304402205a3bc2050752736cd537adc778f4f005dc5573174d2649faae098e6686866ee802200663b9fbc8c6f31a06030d8f30fb650b0dbeb90d46a0c217c729e9159db01a00012821039fc0df3e379ce6bc247a33fe723e64a942d778153ad13d0e4908e7f046298218ac736460b26802483045022100fec9e6ee2908d4978dcd9cf1f45e0c07cdee1361c66e128ab09361aea4fd701a022049f4c0252e2bbfb5c094c492fa8d84a549a0f0748daf96dec2bb13bfd1e6e7f7012102b7bad643b2b5d170fe242680d3ff3c2534ddae44ff163690db1fab7fa1c07f775e1a2500',
      vin: 2,
    },
    description: 'Anchor output type',
    expected: {type: 'anchor'},
  },
];

tests.forEach(({args, description, expected}) => {
  return test(description, ({end, equal}) => {
    const {type} = resolutionType(args);

    equal(type, expected.type, 'Type is resolved');

    return end();
  });
});
